- name: Verificando se mBot já existe
  stat:
     path: /home/mindmakers/mbot/mBlock_RaspberryPI.zip
  register: mbot
- name: Criando a pasta mBot
  file:
    path: /home/mindmakers/mbot
    state: directory
    mode: 0755
- name: Baixando arquivo de instalação mBot -- Este passo pode demorar bastante --
  get_url:
    url: http://download.makeblock.com/mBlock_RaspberryPI.zip
    dest: /home/mindmakers/mbot
    timeout: 60
    mode: 0744
  when: not mbot.stat.exists
- name: Verificando se mBot já foi extraído
  stat:
     path: /home/mindmakers/mbot/mBlock_RaspberryPI/mBlock
  register: mbotext
#- name: Extraindo mbot.zip
#  unarchive:
#    src: /home/mindmakers/mbot/mBlock_RaspberryPI.zip
#    dest: /home/mindmakers/mbot
#    remote_src: yes
#    list_files: yes
#  when: not mbotext.stat.exists
- name: Extraindo mBlock_RaspberryPI.zip    #testar para ver se funciona mais rápido
  shell: 'unzip mBlock_RaspberryPI.zip'
  args:
     chdir: /home/mindmakers/mbot
  when: not mbotext.stat.exists
#- name: Baixando e extraindo arquivo mBlock_RaspberryPI -- Este passo pode demorar bastante--
#  unarchive:
#    src: http://download.makeblock.com/mBlock_RaspberryPI.zip
#    dest: /home/mindmakers/mbot
#    remote_src: yes
#  when: not mbot.stat.exists
- name: Instando pacotes npm baseados no package.json.
  npm:
    path: /home/mindmakers/mbot/mBlock_RaspberryPI/desktop-app
  when: not mbotext.stat.exists
